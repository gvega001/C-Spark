@page "/editor"
@using CSparkIDE.Shared.Services
@using BlazorMonaco
@inject IFormFactor FormFactor

<PageTitle>Editor</PageTitle>

<style>
    .editor-container {
        display: grid;
        grid-template-columns: 250px auto;
        grid-template-rows: auto 200px;
        gap: 10px;
        height: 100vh;
        padding: 10px;
        background: #1e1e1e;
        color: #fff;
    }

    .sidebar {
        background: #252526;
        padding: 15px;
        border-radius: 8px;
    }

    .editor-panel {
        display: flex;
        flex-direction: column;
        background: #2d2d2d;
        padding: 10px;
        border-radius: 8px;
    }

    .console-panel {
        grid-column: span 2;
        background: #252526;
        padding: 10px;
        border-radius: 8px;
    }

    button {
        margin-top: 10px;
        padding: 8px 12px;
        border: none;
        cursor: pointer;
        border-radius: 5px;
        font-weight: bold;
    }

    .btn-primary {
        background: #007acc;
        color: white;
    }

    .btn-secondary {
        background: #3c3c3c;
        color: white;
    }

    ul {
        list-style: none;
        padding: 0;
    }

        ul li {
            padding: 5px;
            cursor: pointer;
        }

            ul li:hover {
                background: #3c3c3c;
            }
</style>

<div class="editor-container">
    <!-- Sidebar: File Explorer -->
    <div class="sidebar">
        <h3>Project Explorer</h3>
        <button class="btn btn-primary" @onclick="CreateNewFile">New File</button>
        <ul>
            @foreach (var file in files)
            {
                <li @onclick="() => OpenFile(file)">@file</li>
            }
        </ul>
    </div>

    <!-- Main Code Editor Panel -->
    <div class="editor-panel">
        <h3>Code Editor</h3>
        <MonacoEditor> 
            
            @code
            {

            }
        </MonacoEditor>
    </div>

    <!-- Console & Debugging Panel -->
    <div class="console-panel">
        <h3>Console Output</h3>
        <pre>@consoleOutput</pre>
        <button class="btn-secondary" @onclick="RunCode">Run Code</button>
    </div>
</div>

@code {
    private string factor => FormFactor.GetFormFactor();
    private string platform => FormFactor.GetPlatform();
    private List<string> files = new() { "main.cs", "utils.cs", "game.cs" };
    private string consoleOutput = "Waiting for execution...";
    private string code = "// Write your C-Spark code here...";

    private MonacoEditor editorOptions = new MonacoEditor
    {
    };

    private void CreateNewFile()
    {
        string newFileName = $"newfile{files.Count + 1}.cs";
        files.Add(newFileName);
    }

    private void OpenFile(string fileName)
    {
        consoleOutput = $"Opened {fileName}";
    }

    private void RunCode()
    {
        consoleOutput = "Executing... (Future integration with transpiler here)";
    }
}
